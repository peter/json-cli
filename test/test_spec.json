{
    "tests": [
        {
            "name": "echo_no_arg",
            "command": "echo '{\"foo\": 1}' | json",
            "expected": "{\"foo\": 1}"
        },
        {
            "name": "echo_dot",
            "command": "echo '{\"foo\": 1}' | json .",
            "expected": "{\"foo\": 1}"
        },
        {
            "name": "echo_data",
            "command": "echo '{\"foo\": 1}' | json data",
            "expected": "{\"foo\": 1}"
        },
        {
            "name": "get_path",
            "command": "cat test/input/basic.json | json '.nested?.foo?.bar'",
            "expected": "nested value"
        },
        {
            "name": "file_path_arg",
            "command": "json .foo test/input/basic.json",
            "expected": "1"
        },
        {
            "name": "lodash_sum",
            "command": "cat test/input/basic.json | json 'sum(data.data.map(i => i.value))'",
            "expected": "600"
        },
        {
            "name": "object_keys",
            "command": "cat test/input/basic.json | json 'Object.keys(data)'",
            "expected": "[\"foo\", \"bar\", \"baz\", \"nested\", \"data\"]"
        },
        {
            "name": "array_length",
            "command": "cat test/input/basic.json | json '.data.length'",
            "expected": "3"
        },
        {
            "name": "flatten_json",
            "command": "cat test/input/basic.json | json 'flattenJson(data)'",
            "expected": "{\"foo\": 1, \"bar\": \"Hello world\", \"baz\": false, \"nested.foo.bar\": \"nested value\", \"data.0.id\": 1, \"data.0.name\": \"Item 1\", \"data.0.value\": 100, \"data.1.id\": 2, \"data.1.name\": \"Item 2\", \"data.1.value\": 200, \"data.2.id\": 3, \"data.2.name\": \"Item 3\", \"data.2.value\": 300}"
        },
        {
            "name": "stats",
            "command": "cat test/input/basic.json | json 'pick(stats(data.data.map(i => i.value)), [\"min\", \"max\", \"avg\", \"p50\", \"p90\"])'",
            "expected": "{\"min\": 100, \"max\": 300, \"avg\": 200, \"p50\": 200, \"p90\": 280}"
        },
        {
            "name": "jsonl_input",
            "command": "cat test/input/array.jsonl | json",
            "expected": "[{\"id\":1,\"name\":\"Item 1\",\"value\":100},{\"id\":2,\"name\":\"Item 2\",\"value\":200},{\"id\":3,\"name\":\"Item 3\",\"value\":300}]"
        },
        {
            "name": "log_with_json_input",
            "command": "cat test/input/log-with-json.log | json 'sum(data.map(d => d.duration_ms))'",
            "expected": "141"
        },
        {
            "name": "custom_helper_functions",
            "command": "echo '{\"values1\": [1, 2, 3, 4], \"values2\": [3, 5, 1, 11]}' | JSON_HELPERS_PATH=\"$(pwd)/test/custom-helpers.js\" json 'round(correlation(data.values1, data.values2), 3)'",
            "expected": "0.598"
        },
        {
            "name": "json_stringifier_default",
            "command": "cat test/input/basic.json | JSON_STRINGIFIER=default json '.data.map(d => pick(d, [\"value\"]))'",
            "expected": "[{\"value\":100},{\"value\":200},{\"value\":300}]"
        },
        {
            "name": "json_output_json",
            "command": "cat test/input/basic.json | JSON_OUTPUT=json json",
            "expected": "{\"bar\":\"Hello world\",\"baz\":false,\"data\":[{\"id\":1,\"name\":\"Item 1\",\"value\":100},{\"id\":2,\"name\":\"Item 2\",\"value\":200},{\"id\":3,\"name\":\"Item 3\",\"value\":300}],\"foo\":1,\"nested\":{\"foo\":{\"bar\":\"nested value\"}}}"
        },
        {
            "name": "json_output_raw",
            "command": "cat test/input/basic.json | JSON_OUTPUT=raw json '.data.map(d => d.value)'",
            "expected": "[ 100,200,300 ]"
        },
        {
            "name": "json_output_jsonl",
            "command": "cat test/input/array.jsonl | JSON_OUTPUT=jsonl json",
            "expected": "{\"id\":1,\"name\":\"Item 1\",\"value\":100}\n{\"id\":2,\"name\":\"Item 2\",\"value\":200}\n{\"id\":3,\"name\":\"Item 3\",\"value\":300}"
        }
    ]
}